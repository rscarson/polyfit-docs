---
import BaseLayout from '../layouts/base.astro';
import Markdown from '../components/markdown.astro';
import { includeBasis } from '../lib/basis';

const basis = includeBasis('index');

const featureCards = [
	{
		title: 'Performance Focused',
		desc: 'Optimized for speed and memory efficiency',
		features: [
			'Blazing fast on both large and small datasets.',
			'Handles 100 million-row Chebyshev fits in ~1 s (8 cores, 2.2 GHz).',
			'Scales sub-linearly with data size, even on consumer-grade hardware',
			'3rd-degree Chebyshev over 1 000 rows takes only ~23 µs.',
			'Compare to 200 µs for numPy',
		],
		link: '/features#performance',
	},
	{
		title: 'Opinionated, yet flexible',
		desc: 'Sane, adaptive defaults allow you to make the right choices for your data',
		features: [
			'Automatic model selection resistant to outliers, and overfitting',
			'Built-in tools to select the right basis for your data',
			'Safe API and developer-first documentation give you the full power of polyfit without needing a PhD in stats',
			'Adaptive domain-scaling to make sure your choice of basis works for your data',
		],
		link: '/features#simplicity',
	},
	{
		title: 'Testing made simple',
		desc: 'Bridging the gap between statistical rigor and engineering pragmatism',
		features: [
			'Included test-suite brings statistical model validation into your workflow',
			'Comprehensive documentation, examples, and sane defaults take the guesswork out of testing',
			'Data-generation, transforming, and function mock-ups included',
			'Failed tests generate a detailed plot for easy, visual debugging',
		],
		link: '/testing',
	}
]

---

<BaseLayout title="Home" path="/">
	<section class="jumbotron">
		<h4 class="fw-bold" style="color: #1e3c72;">
			Because you don't need to be able to build a powerdrill to use one
			safely
		</h4>
		<p class="lead mt-3 text-secondary">
			Statistics is hard, and linear regression is made entirely out of footguns.<br />
		</p>

		<div class="buttons d-flex justify-content-center gap-3 my-4">
			<a href="https://github.com/your-repo/polyfit" class="btn btn-dark " target="_blank">
				<i class="bi bi-github me-2"></i> GitHub
			</a>
			<a href="https://docs.rs/polyfit" class="btn btn-light " target="_blank">
				<i class="bi bi-book me-2"></i> Docs.rs
			</a>
			<a href="https://crates.io/crates/polyfit" class="btn btn-warning " target="_blank">
				<i class="bi bi-box-seam me-2"></i> Crates.io
			</a>
		</div>
	</section>

	<section class="row row-cols-1 row-cols-md-2">
		<div class="col p-5 pt-0">
			<h2 class="mb-3">What is Polyfit?</h2>
			<p class="lead mt-3">
				Polyfit is a high-performance, easy-to-use polynomial fitting library for Rust, designed to make curve fitting
				accessible to software engineers without a background in statistics.
			</p>
		</div>
		
		<div class="col p-5 pt-0">
			<h2 class="mb-3">Why Polyfit?</h2>
			<p class="lead mt-3">
				Polyfit is designed to make curve fitting easy and accessible, without requiring a deep understanding of the
				underlying mathematics - Built by a software engineer for software engineers.
			</p>
		</div>
	</section>

	<section class="mb-5">
		<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
			{featureCards.map(card => (
				<div class="col">
					<div class="card m-3 p-1 shadow-sm feature-card">
						<div class="card-body" style="text-align: left !important;">
							<div class="text-left">
								<h5 class="mb-1">{card.title}</h5>
								<p class="text-muted mb-2">{card.desc}</p>
							</div>
							<small>
								{card.features.map(feature => (
									<p class="m-2 pb-2">&check; {feature}</p>
								))}
							</small>

							<a href={card.link} class="btn btn btn-outline-secondary mt-3">Learn more</a>
						</div>
					</div>
				</div>
			))}
		</div>
	</section>

	<section class="mb-5">
	<h2 class="mb-3">Basis Agnostic</h2>
		<p class="lead mt-3 col-12 col-md-5 mx-auto">
			Polyfit is generic over the choice of basis, and handles the domains and details, giving you the flexibility to
			choose the best fit for your data, and to seamlessly switch basis as needed.
		</p>

		<ul id="home-basis" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 list-unstyled">
		{basis.map((b) => (
			<li class="col">
				<a class="card h-100 p-3 text-decoration-none d-block" href={`/glossary#${b.id}`}>
					<h3 class="h6 mb-1">{b.name}</h3>
					<div class="text-muted small mb-0">
						<Markdown items={b.desc} />
					</div>
				</a>
			</li>
		))}
		</ul>
	</section>
</BaseLayout>